jQuery(document).ready(function($){// ------ 加载菜单 ------$(".header_box").next(".menu, .nav").insertAfter(".chengshixuanze").show();// ------ 调整导航菜单，居中对齐 ------var $nav = $(".header>.nav");var $li  = $(".header>.nav>ul>li");var margin_left_size = (600-$nav.width())/($li.size()+1);$li.css("margin-left", margin_left_size+"px");// ------ 显示“地区选择模块” ------var $city_search_input = $(".abc_input_noconflict");var $region_box = $(".select_hide_noconflict");var city_search_input_prompt = "快速搜索城市（支持全拼/简拼）";function hide_regoin_box(event){//隐藏"地区选择模块"	if ($region_box.has(event.target).size()==0 || $(".beijing_noconflict").has(event.target).size()>0 || $(event.target).is(".beijing_noconflict, .city-seach_noconflict button")){		$region_box.hide();		$('body').unbind('click', hide_regoin_box);//移除监听事件(隐藏"地区选择模块")	}}$(".select-city_noconflict").click(function(){	$city_search_input.val(city_search_input_prompt).css({"color":""});//重置"城市搜索输入框"的内容	$(".city1_box_noconflict").hide().find(".city1_box_body_noconflict ul").empty().next(".err_txt").remove();//移除上次的搜索结果	$region_box.show().find(".change_city_bg").show().find(".change_city_box").css({"top":"-7px","left":"-217px"}).find(".pro_city3_list2_noconflict").hide();//显示"地区选择模块"	$('body').click(hide_regoin_box);	return false;//防止事件冒泡});// ------ 在列表中选择城市 ------$(".pro_city3_list1_noconflict a:not('.off')").click(function(){//点击一级城市时显示其二级城市列表		var proid = $(this).attr("id");	if($("#city"+proid)[0]){	    $(".limiter_noconflict").appendTo($(this).parent());		 var isshow=$("#city"+proid).is(":visible");			if(isshow){										 $("#city"+proid).siblings().hide();					 $("#city"+proid).hide();				 }else{				     $("#city"+proid).show();					 $("#city"+proid).siblings().hide();				}			}else{	    $(".pro_city3_list2_noconflict").hide();	}		$(".top_arrow_noconflict").css({"left":$(this).position().left});	return false;});$(".pro_city3_data_noconflict>a, .pro_body_bg_noconflict>span").hover(function(){//鼠标移进移出城市名称的显示效果	$(this).css({"background-color":"#F1F4F9"});},function(){	$(this).css({"background-color":""});});// ------ 城市搜索 ------$city_search_input.focus(function(){//隐藏"城市搜索输入框"的提示语	if(/^[a-zA-Z]+$/.test($.trim($(this).val()))){		$city_search_input.keyup();	}else{		$(this).val("").css({"color":"#000"});	}}).blur(function(){//显示"城市搜索输入框"的提示语	if(/^\s*$/.test($(this).val())){		$(this).val(city_search_input_prompt).css({"color":""});	};}).keyup(function(){//城市搜索	// ------ 取数 ------	if (!cityData) {		if($(".city1_box_body_noconflict").children().hasClass("err_txt")) return false;		else $(".city1_box_body_noconflict").append('<div class="err_txt" style="margin:5px 10px;">对不起，获取省市拼音数据失败。</div>');		$(".city1_box_noconflict").show();		return true;	}	if (!cityPingyinData.length>0) {		for (var i in cityData) {			var nm = cityData[i].cityName;			var co = cityData[i].cityCode;			var py = cityData[i].cityPingyin;			if (py.length>0)				cityPingyinData.push({"cityName":nm,"cityCode":co,"cityPingyin":py});			var city2 = cityData[i].children;			for (var j in city2) {				var nm = city2[j].cityName;				var co = city2[j].cityCode;				var py = city2[j].cityPingyin;				if (py.length>0)				cityPingyinData.push({"cityName":nm,"cityCode":co,"cityPingyin":py});			}		}	}	if (!cityPingyinData.length>0) {		if($(".city1_box_body_noconflict").children().hasClass("err_txt")) return false;		else $(".city1_box_body_noconflict").append('<div class="err_txt" style="margin:5px 10px;">对不起，暂无可用省市拼音数据。</div>');		$(".city1_box_noconflict").show();		return true;	}	$(".city1_box_noconflict").hide().find(".city1_box_body_noconflict ul").empty().next(".err_txt").remove();//移除上次的搜索结果	// ------ 搜索并生成结果列表 ------	var val_txt = $(this).val().replace(/\s/g,"");	if (val_txt==="") return false;	var counter = 0;	var size = 5; //只显示前N个匹配结果	$.each(cityPingyinData, function(i,item){		var keyword = item.cityPingyin;		var cityname = item.cityName;		var finder = 0;		var index1 = keyword.toLocaleLowerCase().indexOf(val_txt.toLocaleLowerCase())//全拼搜索		var index2 = keyword.replace(/[a-z]/g,"").indexOf(val_txt.toLocaleUpperCase());//简拼搜索		var index3 = cityname.indexOf(val_txt);  //中文搜索		if(index1==0){			keyword = '<b class="red_city">'+keyword.substr(0,val_txt.length)+'</b>'+keyword.substr(val_txt.length);			finder = 1;		}else if(index2==0){ 			keyword = keyword.replace(new RegExp("(["+val_txt.toLocaleUpperCase()+"])","g"),'<b class="red_city">$1</b>');			finder = 1;		}else if(index3==0){			cityname = cityname.replace(val_txt,'<b class="red_city">'+val_txt+'</b>');			finder = 1;		}		if (finder){			$(".city1_box_body_noconflict ul").append('<li class="clearfix show_city" style="margin: 0;"><span style="float: right;">'+keyword+'</span><span id="'+item.cityCode+'">'+cityname+'</span></li>');			if(!(++counter<size))				return false;	   }	});	if(counter==0){		if($(".city1_box_body_noconflict").children().hasClass("err_txt")) return false;		else $(".city1_box_body_noconflict").append('<div class="err_txt" style="margin:5px 10px;">对不起，未找到该关键字。</div>');	}else{		if($(".city1_box_body_noconflict").children().hasClass("err_txt")) $(".err_txt").remove();	}	$(".city1_box_noconflict").show();	// ------ 搜索结果的选择效果 ------	$(".show_city").hover(function(){		$(this).addClass("city_hover");	},function(){		$(this).removeClass("city_hover");	}).click(function(){		$city_search_input.val($(this).find("span:last").text());		$("#city_code_id_noconflict").val($(this).find("span:last").attr("id"));		$(this).parents(".city1_box_noconflict").hide();	});});$(".change_city_body_noconflict, .pro_city3_data_noconflict>a").click(function(){//当点击"城市选择列表"时隐藏搜索结果列表	$(".city1_box_noconflict").hide();}); });